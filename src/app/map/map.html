<div class="min-h-screen bg-gradient-to-br from-gray-900 to-gray-800 text-white">

  <!-- Container principal centralizado -->
  <div class="container mx-auto px-4 py-8 max-w-4xl">

    <!-- Header centralizado -->
    <div class="text-center mb-8">
      <h1 class="text-3xl font-bold bg-gradient-to-r from-red-400 to-red-600 bg-clip-text text-transparent mb-2">
        Nossos Lugares Especiais
      </h1>
      <p class="text-gray-400 text-sm">Explore nossa jornada atrav√©s do mapa</p>

      <!-- Estat√≠sticas -->
      <div class="flex justify-center gap-6 mt-4 text-sm">
        <div class="text-center">
          <div class="text-2xl font-bold text-red-400">{{ getStats().visited }}</div>
          <div class="text-gray-400">Visitados</div>
        </div>
        <div class="text-center">
          <div class="text-2xl font-bold text-blue-400">{{ getStats().planned }}</div>
          <div class="text-gray-400">Planejados</div>
        </div>
        <div class="text-center">
          <div class="text-2xl font-bold text-gray-300">{{ getStats().total }}</div>
          <div class="text-gray-400">Total</div>
        </div>
      </div>
    </div>

    <!-- Mapa principal -->
    <div
      id="map"
      class="map map-home leaflet-container leaflet-touch leaflet-retina leaflet-fade-anim leaflet-grab leaflet-touch-drag leaflet-touch-zoom"
      style="height: 60vh; margin-top: 20px; position: relative; width: 100%; border-radius: 12px; overflow: hidden; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);"
      tabindex="0">
    </div>

    <!-- Interface para adicionar nova viagem -->
    <div class="mb-8 flex justify-center mt-8">
      <button
        (click)="navigateToAddPlace()"
        class="px-6 py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white font-medium rounded-xl transition-all transform hover:scale-105 shadow-lg flex items-center gap-2"
      >
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
        </svg>
        Adicionar Nova Viagem
      </button>
    </div>

    <!-- Lista com scroll -->
    <div class="space-y-6">

      <!-- Lugares Visitados -->
      <div *ngIf="visitedPlaces.length > 0">
        <h2 class="text-xl font-semibold text-red-400 mb-4">
          Lugares que J√° Visitamos ({{ visitedPlaces.length }})
        </h2>

        <!-- Container com scroll -->
        <div class="max-h-80 overflow-y-auto space-y-3 pr-2">
          <div
            *ngFor="let place of visitedPlaces; trackBy: trackByPlace"
            class="bg-gray-800/40 rounded-xl p-4 transition-all border border-red-500/30 shadow-lg relative"
          >
            <!-- Menu dropdown button -->
            <div class="absolute top-3 right-3 flex items-center gap-2">
              <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-600 text-white">
                Visitado
              </span>
              <button
                (click)="togglePlaceMenu(place.id, $event)"
                class="p-1.5 bg-gray-700 hover:bg-gray-600 text-white rounded-full transition-colors"
                title="Op√ß√µes"
              >
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"></path>
                </svg>
              </button>
            </div>

            <!-- Dropdown menu -->
            <div *ngIf="activeMenuId === place.id" class="absolute top-12 right-3 bg-gray-800 border border-gray-600 rounded-lg shadow-xl z-50 w-48">
              <button
                (click)="editVisitDescription(place, $event); closeMenu()"
                class="w-full text-left px-4 py-2 hover:bg-gray-700 text-white text-sm flex items-center gap-2 rounded-t-lg"
              >
                ‚úèÔ∏è Editar descri√ß√£o
              </button>
              <button
                (click)="deletePlace(place, $event); closeMenu()"
                class="w-full text-left px-4 py-2 hover:bg-gray-700 text-red-400 text-sm flex items-center gap-2 rounded-b-lg"
              >
                üóëÔ∏è Remover lugar
              </button>
            </div>

            <div class="pr-16" (click)="focusPlaceByObject(place)">
              <h3 class="font-semibold text-white mb-2">{{ place.name }}</h3>
              <p class="text-gray-400 text-sm mb-2 line-clamp-2">{{ place.visitDescription || place.description }}</p>
              <p class="text-red-400 text-xs">
                Visitado em {{ formatDate(place.visitDate!) }}
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Lugares Planejados -->
      <div *ngIf="plannedPlaces.length > 0">
        <h2 class="text-xl font-semibold text-red-400 mb-4">
          Lugares que Queremos Visitar ({{ plannedPlaces.length }})
        </h2>

        <!-- Container com scroll -->
        <div class="max-h-80 overflow-y-auto space-y-3 pr-2">
          <div
            *ngFor="let place of plannedPlaces; trackBy: trackByPlace"
            class="bg-gray-800/40 rounded-xl p-4 transition-all border border-blue-500/30 shadow-lg relative"
          >
            <!-- Menu dropdown button -->
            <div class="absolute top-3 right-3 flex items-center gap-2">
              <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-600 text-white">
                Planejado
              </span>
              <button
                (click)="togglePlaceMenu(place.id, $event)"
                class="p-1.5 bg-gray-700 hover:bg-gray-600 text-white rounded-full transition-colors"
                title="Op√ß√µes"
              >
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"></path>
                </svg>
              </button>
            </div>

            <!-- Dropdown menu -->
            <div *ngIf="activeMenuId === place.id" class="absolute top-12 right-3 bg-gray-800 border border-gray-600 rounded-lg shadow-xl z-50 w-48">
              <button
                (click)="markAsVisited(place, $event); closeMenu()"
                class="w-full text-left px-4 py-2 hover:bg-gray-700 text-white text-sm flex items-center gap-2 rounded-t-lg"
              >
                ‚úÖ Marcar como visitado
              </button>
              <button
                (click)="editPlannedDescription(place, $event); closeMenu()"
                class="w-full text-left px-4 py-2 hover:bg-gray-700 text-white text-sm flex items-center gap-2"
              >
                ‚úèÔ∏è Editar descri√ß√£o
              </button>
              <button
                (click)="deletePlace(place, $event); closeMenu()"
                class="w-full text-left px-4 py-2 hover:bg-gray-700 text-red-400 text-sm flex items-center gap-2 rounded-b-lg"
              >
                üóëÔ∏è Remover lugar
              </button>
            </div>

            <div class="pr-16" (click)="focusPlannedPlaceByObject(place)">
              <h3 class="font-semibold text-white mb-2">{{ place.name }}</h3>
              <p class="text-gray-400 text-sm mb-2 line-clamp-2">{{ place.description }}</p>
              <p class="text-blue-400 text-xs">
                Planejado para {{ formatDate(place.plannedDate!) }}
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Mensagem quando n√£o h√° lugares -->
      <div *ngIf="visitedPlaces.length === 0 && plannedPlaces.length === 0" class="text-center py-12">
        <div class="text-gray-500 mb-4">
          <svg class="w-16 h-16 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
          </svg>
        </div>
        <h3 class="text-xl font-semibold text-gray-400 mb-2">Ainda n√£o h√° lugares adicionados</h3>
        <p class="text-gray-500 mb-6">Comece planejando sua pr√≥xima aventura!</p>
        <button
          (click)="navigateToAddPlace()"
          class="px-6 py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white font-medium rounded-xl transition-all transform hover:scale-105 shadow-lg"
        >
          Adicionar Primeiro Lugar
        </button>
      </div>
    </div>

  </div>

  <!-- Bot√£o flutuante para adicionar lugar -->
  <button
    (click)="navigateToAddPlace()"
    class="fixed bottom-6 right-6 w-14 h-14 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white rounded-full shadow-lg hover:shadow-xl transition-all transform hover:scale-110 flex items-center justify-center z-40"
    title="Adicionar nova viagem"
  >
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
    </svg>
  </button>
</div>